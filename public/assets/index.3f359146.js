var T=Object.defineProperty,b=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var y=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var v=(e,t,r)=>t in e?T(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))A.call(t,r)&&v(e,r,t[r]);if(y)for(var r of y(t))O.call(t,r)&&v(e,r,t[r]);return e},C=(e,t)=>b(e,x(t));import{V as N,r as u,o as d,c as h,a as m,b as n,t as a,d as I,p as R,e as $,F as L,f as B,g as w,m as P,h as S,w as V,v as k,i as J}from"./vendor.c3e73352.js";const U=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(s){if(s.ep)return;s.ep=!0;const o=r(s);fetch(s.href,o)}};U();var _=(e,t)=>{const r=e.__vccOpts||e;for(const[l,s]of t)r[l]=s;return r};const F={name:"AppSelect",components:{VSelect:N},props:{options:Array,refreshing:Boolean},emits:{"refresh-select-list":null,"add-crypto":null},data(){return{selected:null,refreshButtonText:"Refresh",intervalId:null}},watch:{refreshing:{handler(e){e?(this.refreshButtonText=".",this.intervalId=setInterval(()=>{this.refreshButtonText.length>2?this.refreshButtonText=".":this.refreshButtonText+="."},333)):(clearInterval(this.intervalId),this.refreshButtonText="\u21BB")},immediate:!0}},unmounted(){clearInterval(this.intervalId)},methods:{onInput(){var e;((e=this.selected)==null?void 0:e.code)==="Refresh"?this.$emit("refresh-select-list"):this.selected&&this.$emit("add-crypto",C(g({},this.selected),{amount:0})),this.selected=null}}},E={class:"app-select"};function D(e,t,r,l,s,o){const i=u("v-select");return d(),h("div",E,[m(i,{class:"app-select__vselect",placeholder:"Add crypto",options:r.options,modelValue:s.selected,"onUpdate:modelValue":t[0]||(t[0]=p=>s.selected=p),onClose:o.onInput},null,8,["options","modelValue","onClose"]),n("button",{onClick:t[1]||(t[1]=p=>e.$emit("refresh-select-list")),class:"app-select__refresh"},a(s.refreshButtonText),1)])}var j=_(F,[["render",D],["__scopeId","data-v-01a44d86"]]);const q={name:"CryptoCard",props:{symbol:String,label:String,amount:Number,currency:String,price:Number,holdings:Number},emits:{"remove-crypto":null,"set-crypto-price":Number},data(){return{_amount:this.amount}},computed:{_price(){let e=this.price;return e=typeof e=="number"?e.toFixed(3):"-",e}},methods:{handleAmount(e){this._amount=Number(e.target.value),this.$emit("set-crypto-price",this._amount)}}},z=e=>(R("data-v-811d09d8"),e=e(),$(),e),M={class:"crypto-card"},H={class:"crypto-card__title"},K=I("Price: "),G={class:"crypto-card__price"},Q={class:"crypto-card__amount"},W=z(()=>n("span",{class:"crypto-card__amount__label"},"Amount:",-1)),X=["value"],Y=I("Holdings: "),Z={class:"crypto-card__holdings"};function ee(e,t,r,l,s,o){return d(),h("div",M,[n("button",{class:"crypto-card__close",onClick:t[0]||(t[0]=i=>e.$emit("remove-crypto"))},"x"),n("p",H,a(r.label)+" / "+a(r.currency),1),n("p",null,[K,n("span",G,a(o._price),1)]),n("div",Q,[W,n("input",{class:"crypto-card__amount__input",type:"number",value:s._amount,onInput:t[1]||(t[1]=(...i)=>o.handleAmount&&o.handleAmount(...i)),size:"10"},null,40,X)]),n("p",null,[Y,n("span",Z,a(r.holdings||"-"),1)])])}var te=_(q,[["render",ee],["__scopeId","data-v-811d09d8"]]);const re={name:"ListOfCrypto",components:{CryptoCard:te},props:{selectedCrypto:Array,currency:String}},se={class:"crypto-list"};function oe(e,t,r,l,s,o){const i=u("crypto-card");return d(),h("div",se,[(d(!0),h(L,null,B(r.selectedCrypto,(p,c)=>(d(),w(i,P({class:"crypto-list__card"},p,{currency:r.currency,key:c,onRemoveCrypto:f=>e.$emit("remove-crypto",c),onSetCryptoPrice:f=>e.$emit("set-crypto-price",{val:f,idx:c})}),null,16,["currency","onRemoveCrypto","onSetCryptoPrice"]))),128))])}var ne=_(re,[["render",oe],["__scopeId","data-v-fe219070"]]);const le={components:{AppSelect:j,CryptoList:ne},setup(){let e;try{e=JSON.parse(localStorage.getItem("selectOptions"))}catch{localStorage.removeItem("selectOptions")}finally{e!=null&&e.length||(e=[{code:"Refresh",label:"Refresh crypto list."}],localStorage.setItem("selectOptions",JSON.stringify(e)))}let t;try{t=JSON.parse(localStorage.getItem("selectedCrypto"))}catch{localStorage.removeItem("selectedCrypto")}return{selectedCrypto:S(t!=null?t:[]),selectOptions:S(e)}},data(){return{apiUrl:"https://api.binance.com/api/v3/",currency:"USDT",refreshingSelect:!1,refreshTime:localStorage.getItem("refreshTime")||60,refreshId:null}},computed:{holdings(){return this.selectedCrypto.reduce((e,t)=>e+t.holdings,0).toFixed(2)}},watch:{holdings(){window.document.title=this.holdings+" "+this.currency}},mounted(){this.setRefreshInterval()},methods:{refetchCryptoList(){this.refreshingSelect=!0,fetch(this.apiUrl+"exchangeInfo").then(e=>e.json()).then(e=>{this.selectOptions=this.parseSymbols(e==null?void 0:e.symbols),localStorage.setItem("selectOptions",JSON.stringify(this.selectOptions))}).finally(()=>this.refreshingSelect=!1),this.refreshCrypto()},parseSymbols(e){const t=[];return e==null||e.forEach(r=>{if(r.quoteAsset===this.currency){const l={symbol:r.symbol,label:`${r.baseAsset}`};t.push(l)}}),t},addCrypto(e){this.selectedCrypto=[...this.selectedCrypto,e],localStorage.setItem("selectedCrypto",JSON.stringify(this.selectedCrypto)),this.refreshCrypto()},removeCrypto(e){this.selectedCrypto.splice(e,1),this.selectedCrypto=[...this.selectedCrypto],localStorage.setItem("selectedCrypto",JSON.stringify(this.selectedCrypto))},refreshCrypto(){this.selectedCrypto.forEach(e=>{fetch(this.apiUrl+"avgPrice?symbol="+e.symbol).then(t=>t.json()).then(t=>e.price=+t.price).finally(()=>e.holdings=+(e.amount*e.price).toFixed(2))})},validateRefreshTime(e){const t=e.target.value;t===0?this.refreshTime=0:t<10?this.refreshTime=10:this.refreshTime=t,localStorage.setItem("refreshTime",this.refreshTime),this.setRefreshInterval()},setRefreshInterval(){clearInterval(this.refreshId),this.refreshCrypto(),this.refreshTime&&(this.refreshId=setInterval(this.refreshCrypto,this.refreshTime*1e3))},setCryptoAmount(e){const{val:t,idx:r}=e;this.selectedCrypto[r].amount=t,this.$forceUpdate(),localStorage.setItem("selectedCrypto",JSON.stringify(this.selectedCrypto))}}},ie={class:"wrapper"},ce={class:"app"},ae={class:"app__summary"},pe={class:"app__summary__holdings"},de={class:"app__refresh"},he=n("span",null,"Refresh (min 10 sec):",-1);function ue(e,t,r,l,s,o){const i=u("app-select"),p=u("crypto-list");return d(),h("div",ie,[n("div",ce,[n("div",ae,[n("span",pe,a(o.holdings)+" "+a(s.currency),1)]),n("div",de,[he,V(n("input",{class:"app__refresh__input","onUpdate:modelValue":t[0]||(t[0]=c=>s.refreshTime=c),onChange:t[1]||(t[1]=(...c)=>o.validateRefreshTime&&o.validateRefreshTime(...c)),size:"1"},null,544),[[k,s.refreshTime]])]),m(i,{options:l.selectOptions,refreshing:s.refreshingSelect,onRefreshSelectList:o.refetchCryptoList,onAddCrypto:o.addCrypto},null,8,["options","refreshing","onRefreshSelectList","onAddCrypto"]),m(p,{currency:s.currency,selectedCrypto:l.selectedCrypto,onRemoveCrypto:o.removeCrypto,onSetCryptoPrice:o.setCryptoAmount},null,8,["currency","selectedCrypto","onRemoveCrypto","onSetCryptoPrice"])])])}var _e=_(le,[["render",ue]]);J(_e).mount("#app");
